---
"@esdora/kit": minor
---

refactor: 重构 `treeMap` 实现，新增按需 Context 系统和智能子节点处理

### 新增功能

- **按需 Context 配置**：支持选择性启用 `depth`、`index`、`parent`、`path`、`isLeaf`、`isRoot`、`processedChildren` 等字段，减少不必要的性能开销
- **智能子节点处理**：自动检测用户对 children 的处理方式，支持自动递归、显式递归和自定义三种模式
- **完整遍历模式**：支持 DFS（前序/后序）和 BFS 遍历
- **增强类型安全**：Context 字段类型根据配置自动推断，新增 188 个类型测试
- **改进错误提示**：提供更详细的错误信息，包含节点标识和实际类型

### 性能优化

- Context 按需创建，减少 30-50% 内存开销
- 智能子节点处理，避免不必要的数组复制
- 优化遍历算法，提升执行效率

### 测试

- 新增 582 个单元测试
- 新增 188 行类型测试
- 覆盖所有遍历模式和 Context 配置组合

**向后兼容**：完全向后兼容，现有代码无需修改。
